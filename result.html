<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Result</title>
<link rel="stylesheet" href="style.css">
</head>

<body class="light">

<div class="card">
    <h1>Your Scorecard</h1>
    <p id="student-meta"></p>
    <div class="result-score" id="display-score">0 / 0</div>
    <div id="status-msg"></div>
    <button onclick="goDashboard()">Back to Dashboard</button>
</div>

<script>
window.onload = function () {
    const name = localStorage.getItem("studentName") || "Student";
    const cls = localStorage.getItem("studentClass") || "-";
    const rawData = localStorage.getItem("reviewData");

    if (!rawData) {
        document.body.innerHTML = "<h2>No Data Found!</h2>";
        return;
    }

    const reviewData = JSON.parse(rawData);
    document.getElementById("student-meta").innerText = `${name} | Class: ${cls}`;

    let score = 0;
    const total = reviewData.length;
    reviewData.forEach(q => { if(q.selected === q.correct) score++; });

    document.getElementById("display-score").innerText = `${score} / ${total}`;

    const percent = (score/total)*100;
    document.getElementById("status-msg").innerHTML =
        percent >= 50
        ? "<div class='pass'>RESULT: PASS üéâ</div>"
        : "<div class='fail'>RESULT: FAIL ‚ùå</div>";

    localStorage.setItem("lastExamScore", `${score} / ${total}`);

    fetch("YOUR_GOOGLE_SCRIPT_URL", {
        method: "POST",
        headers: {"Content-Type":"application/json"},
        body: JSON.stringify({name, cls, score, total}),
        mode:"no-cors"
    });
};

function goDashboard() {
    window.location.href = "dashboard.html";
}
</script>

</body>
</html>
