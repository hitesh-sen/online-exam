<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Result | Bothverse Academy</title>
<link rel="stylesheet" href="style.css">
</head>

<body class="light">
<div class="result-box">
    <h1>Your Scorecard</h1>
    <p id="student-meta"></p>
    <div class="score" id="display-score">0 / 0</div>
    <div id="status-msg"></div>
</div>

<script>
window.onload = function () {
    const name = localStorage.getItem("studentName") || "Student";
    const cls = localStorage.getItem("studentClass") || "-";
    const rawData = localStorage.getItem("reviewData");

    if (!rawData) {
        document.body.innerHTML = "<h2>No Data Found!</h2>";
        return;
    }

    const reviewData = JSON.parse(rawData);
    document.getElementById("student-meta").innerText = `${name} | Class: ${cls}`;

    let score = 0;
    const total = reviewData.length;

    reviewData.forEach(item => {
        if (item.selected === item.correct) score++;
    });

    document.getElementById("display-score").innerText = `${score} / ${total}`;
    document.getElementById("status-msg").innerHTML =
        (score / total) * 100 >= 50
        ? "<span style='color:green'>RESULT: PASS</span>"
        : "<span style='color:red'>RESULT: FAIL</span>";

    // âœ… CORRECT Google Sheet Sync
    const scriptURL = "https://script.google.com/macros/s/AKfycbwEo40yBXFZUUn5V-U0xWzfxZc_jb-Fludqe43CN20BAs0TlB05yxngqn0Q37ERUYWgPw/exec";

    fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: name,
            cls: cls,
            score: score,
            total: total
        }),
        mode: "no-cors"
    });
};
</script>
</body>
</html>
