<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Exam Result | Bothverse Academy</title>
<link rel="stylesheet" href="style.css">

<style>
.result-box {
    max-width: 600px;
    margin: 100px auto 40px;
    padding: 30px;
    background: white;
    border-radius: 16px;
    box-shadow: 0 10px 30px rgba(0,0,0,0.1);
    text-align: center;
}

.result-box h1 {
    margin-bottom: 10px;
}

#student-meta {
    color: #475569;
    margin-bottom: 20px;
}

.score {
    font-size: 2.5rem;
    font-weight: bold;
    margin: 15px 0;
    color: #1e293b;
}

#status-msg {
    font-size: 1.3rem;
    font-weight: bold;
    margin-top: 10px;
}
</style>
</head>

<body class="light">
<div class="result-box">
    <h1>Your Scorecard</h1>
    <p id="student-meta"></p>
    <div class="score" id="display-score">0 / 0</div>
    <div id="status-msg"></div>
</div>

<script>
window.onload = function () {
    const name = localStorage.getItem("studentName") || "Student";
    const cls = localStorage.getItem("studentClass") || "-";
    const rawData = localStorage.getItem("reviewData");

    if (!rawData) {
        document.body.innerHTML = "<h2>No Data Found!</h2>";
        return;
    }

    const reviewData = JSON.parse(rawData);
    document.getElementById("student-meta").innerText = `${name} | Class: ${cls}`;

    let score = 0;
    const total = reviewData.length;

    reviewData.forEach(item => {
        if (item.selected === item.correct) score++;
    });

    document.getElementById("display-score").innerText = `${score} / ${total}`;
    document.getElementById("status-msg").innerHTML =
        (score / total) * 100 >= 50
        ? "<span style='color:#16a34a'>RESULT: PASS üéâ</span>"
        : "<span style='color:#dc2626'>RESULT: FAIL ‚ùå</span>";

    // Google Sheet Sync
    const scriptURL = "https://script.google.com/macros/s/AKfycbwEo40yBXFZUUn5V-U0xWzfxZc_jb-Fludqe43CN20BAs0TlB05yxngqn0Q37ERUYWgPw/exec";

    fetch(scriptURL, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({
            name: name,
            cls: cls,
            score: score,
            total: total
        }),
        mode: "no-cors"
    });
};
</script>
</body>
</html>
